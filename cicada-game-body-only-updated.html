<!-- çŸ¥äº†å˜’å˜’éŠæˆ² - é–‹å§‹ -->
<style>
    /* åŸºæœ¬æ¨£å¼ */
    #cicada-game-container {
        font-family: 'Microsoft JhengHei', Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
        background-image: url('images/forest-bg.jpg');
        background-size: cover;
        background-position: center;
        background-blend-mode: overlay;
    }
    
    /* æ¨™é¡Œå€åŸŸ */
    .cicada-title {
        text-align: center;
        margin-bottom: 20px;
        color: #2a7d4f;
    }
    
    /* èªªæ˜å€åŸŸ */
    .cicada-instruction {
        text-align: center;
        margin-bottom: 30px;
        padding: 10px;
        background-color: rgba(42, 125, 79, 0.1);
        border-radius: 5px;
    }
    
    /* è¨ˆåˆ†æ¿ */
    .cicada-scoreboard {
        display: flex;
        justify-content: space-between;
        font-size: 16px;
        margin-bottom: 20px;
        background-color: rgba(42, 125, 79, 0.1);
        padding: 10px;
        border-radius: 5px;
    }
    
    .cicada-progress {
        font-weight: bold;
    }
    
    .cicada-score-display {
        font-weight: bold;
        color: #2a7d4f;
    }
    
    /* éŸ³æª”é¸é …å€åŸŸ */
    .cicada-sound-options {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }
    
    /* å–®å€‹éŸ³æª”é¸é …å¡ç‰‡ */
    .cicada-sound-card {
        background-color: #fff;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
    }
    
    .cicada-sound-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    
    /* æ’­æ”¾æŒ‰éˆ• */
    .cicada-play-button {
        background-color: #2a7d4f;
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        margin-right: 15px;
        transition: background-color 0.2s;
    }
    
    .cicada-play-button:hover {
        background-color: #1e5d3a;
    }
    
    .cicada-play-button .icon {
        font-size: 18px;
    }
    
    .cicada-play-button.playing {
        background-color: #d9534f;
    }
    
    /* å‹¾é¸æ¡†èˆ‡æ¨™ç±¤ */
    .cicada-sound-label {
        display: flex;
        align-items: center;
        font-size: 16px;
        cursor: pointer;
        flex-grow: 1;
    }
    
    .cicada-checkbox {
        margin-right: 10px;
        width: 18px;
        height: 18px;
    }
    
    /* æŒ‰éˆ•å€åŸŸ */
    .cicada-actions {
        text-align: center;
        margin: 20px 0;
    }
    
    .cicada-button {
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin: 0 10px;
        transition: all 0.2s;
    }
    
    .cicada-submit-button {
        background-color: #2a7d4f;
        color: white;
    }
    
    .cicada-submit-button:hover {
        background-color: #1e5d3a;
    }
    
    .cicada-next-button {
        background-color: #3498db;
        color: white;
        display: none;
    }
    
    .cicada-next-button:hover {
        background-color: #2980b9;
    }
    
    /* åé¥‹å€åŸŸ */
    .cicada-feedback {
        padding: 15px;
        margin: 20px 0;
        border-radius: 5px;
        text-align: center;
        display: none;
    }
    
    .cicada-feedback.correct {
        background-color: rgba(46, 204, 113, 0.2);
        border: 1px solid #2ecc71;
    }
    
    .cicada-feedback.incorrect {
        background-color: rgba(231, 76, 60, 0.2);
        border: 1px solid #e74c3c;
    }
    
    /* èŸ¬ç¨®çŸ¥è­˜å½ˆçª— */
    .cicada-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }
    
    .cicada-modal-content {
        background-color: #fff;
        border-radius: 10px;
        max-width: 500px;
        width: 80%;
        padding: 20px;
        position: relative;
    }
    
    .cicada-modal-close {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 24px;
        cursor: pointer;
        color: #555;
    }
    
    .cicada-species-image {
        width: 100%;
        height: auto;
        border-radius: 5px;
        margin-bottom: 15px;
    }
    
    /* çµç®—ç•«é¢æ¨£å¼ */
    .cicada-result-content {
        max-width: 600px;
        text-align: center;
    }
    
    .cicada-final-score {
        background-color: #f8f8f8;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
    }
    
    .cicada-score-comment {
        font-style: italic;
        color: #555;
    }
    
    .cicada-info-box {
        background-color: rgba(42, 125, 79, 0.1);
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .cicada-action-buttons {
        margin: 20px 0;
    }
    
    .cicada-restart-button {
        background-color: #3498db;
        color: white;
    }
    
    .cicada-restart-button:hover {
        background-color: #2980b9;
    }
    
    .cicada-share-button {
        background-color: #2a7d4f;
        color: white;
    }
    
    .cicada-share-button:hover {
        background-color: #1e5d3a;
    }
    
    .cicada-continue-hint {
        margin-top: 20px;
        font-weight: bold;
        color: #e67e22;
        animation: bounce 2s infinite;
    }
    
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {
            transform: translateY(0);
        }
        40% {
            transform: translateY(-10px);
        }
        60% {
            transform: translateY(-5px);
        }
    }
    
    /* åˆ†äº«ç›¸é—œæ¨£å¼ */
    .cicada-share-content {
        max-width: 500px;
    }
    
    .cicada-screenshot-area {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin: 20px 0;
        text-align: center;
    }
    
    .cicada-share-header {
        border-bottom: 2px solid #2a7d4f;
        padding-bottom: 10px;
        margin-bottom: 15px;
    }
    
    .cicada-share-score {
        font-size: 18px;
        font-weight: bold;
        margin: 15px 0;
    }
    
    .cicada-share-image {
        margin: 15px 0;
    }
    
    .cicada-share-date {
        color: #777;
        font-size: 14px;
        margin-top: 15px;
    }
    
    .cicada-download-button {
        background-color: #e74c3c;
        color: white;
    }
    
    .cicada-download-button:hover {
        background-color: #c0392b;
    }
    
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 600px) {
        .cicada-sound-options {
            grid-template-columns: 1fr;
        }
    }
</style>

<div id="cicada-game-container">    <!-- æ¨™é¡Œå€ -->
    <div class="cicada-title">
        <h1>çŸ¥äº†å˜’å˜’</h1>
        <p>ã€Œå˜’å˜’ã€æ˜¯æè¿°èŸ¬é³´è²çš„è±¡è²è©</p>
    </div>
    
    <!-- èªªæ˜å€ -->
    <div class="cicada-instruction">
        <p>è†è½å„ç¨®è²éŸ³ï¼Œå‹¾é¸ä½ èªç‚ºæ˜¯èŸ¬é³´çš„é¸é …ã€‚æŒ‘æˆ°è‡ªå·±è¾¨è­˜ä¸åŒçš„èŸ¬è²ï¼</p>
    </div>
      <!-- è¨ˆåˆ†æ¿å€ -->
    <div class="cicada-scoreboard">
        <div class="cicada-progress">
            é¡Œç›®: <span id="cicada-current-question">1</span> / 5
        </div>
        <div class="cicada-score-display">
            åˆ†æ•¸: <span id="cicada-score">0</span> / 50
        </div>
    </div>
    
    <!-- éŸ³æª”é¸é …å€ -->
    <div id="cicada-sound-options" class="cicada-sound-options">
        <!-- éŸ³æª”é¸é …å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
    </div>
    
    <!-- æŒ‰éˆ•å€ -->
    <div class="cicada-actions">
        <button id="cicada-submit" class="cicada-button cicada-submit-button">ç¢ºèªï¼</button>
        <button id="cicada-next" class="cicada-button cicada-next-button">ä¸‹ä¸€çµ„è²éŸ³</button>
    </div>
    
    <!-- åé¥‹å€ -->
    <div id="cicada-feedback" class="cicada-feedback">
        <!-- ç­”é¡Œçµæœåé¥‹å°‡ç”± JavaScript å‹•æ…‹æ›´æ–° -->
    </div>
</div>

<!-- èŸ¬ç¨®çŸ¥è­˜å½ˆçª— -->
<div id="cicada-modal" class="cicada-modal">
    <div class="cicada-modal-content">
        <span id="cicada-modal-close" class="cicada-modal-close">&times;</span>
        <h2 id="cicada-species-name"></h2>
        <img id="cicada-species-image" class="cicada-species-image" src="" alt="èŸ¬çš„åœ–ç‰‡">
        <p id="cicada-species-description"></p>
    </div>
</div>

<!-- éŠæˆ²çµç®—å½ˆçª— -->
<div id="cicada-result-modal" class="cicada-modal">
    <div class="cicada-modal-content cicada-result-content">
        <span id="cicada-result-close" class="cicada-modal-close">&times;</span>
        <h2>éŠæˆ²çµæŸï¼</h2>
        <div class="cicada-final-score">
            <h3>æ‚¨çš„åˆ†æ•¸: <span id="cicada-final-score">0</span> / 100</h3>
            <p id="cicada-score-comment"></p>
        </div>
        <div class="cicada-info-box">
            <h3>å°ç£ç†ŠèŸ¬</h3>
            <img class="cicada-species-image" src="images/taiwan_bear_cicada.jpg" alt="å°ç£ç†ŠèŸ¬">
            <p>å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚ç‰ å€‘èº«é«”é»‘è¤è‰²ï¼Œæœ‰è‘—ç‰¹æ®Šçš„ç¿…è†€åœ–æ¡ˆï¼Œæ˜¯å°ç£æœ€å—æ­¡è¿çš„èŸ¬ç¨®ä¹‹ä¸€ã€‚</p>
        </div>
        <div class="cicada-action-buttons">
            <button id="cicada-restart" class="cicada-button cicada-restart-button">å†ç©ä¸€æ¬¡</button>
            <button id="cicada-share" class="cicada-button cicada-share-button">åˆ†äº«çµæœ</button>
        </div>
        <div class="cicada-continue-hint">
            <p>ğŸ‘‡ ç¹¼çºŒå¾€ä¸‹æ»‘ï¼Œæ¢ç´¢æ›´å¤šé—œæ–¼èŸ¬çš„æœ‰è¶£å…§å®¹ï¼</p>
        </div>
    </div>
</div>

<!-- æˆªåœ–å½ˆçª— -->
<div id="cicada-share-modal" class="cicada-modal">
    <div class="cicada-modal-content cicada-share-content">
        <span id="cicada-share-close" class="cicada-modal-close">&times;</span>
        <h2>åˆ†äº«æ‚¨çš„æˆç¸¾</h2>
        <div id="cicada-screenshot-area" class="cicada-screenshot-area">
            <div class="cicada-share-header">
                <h3>èŸ¬é³´çŸ¥å¤šå°‘ - æŒ‘æˆ°çµæœ</h3>
            </div>
            <div class="cicada-share-score">
                <p>æˆ‘åœ¨ã€ŒèŸ¬é³´çŸ¥å¤šå°‘ã€æŒ‘æˆ°ä¸­ç²å¾—äº† <span id="cicada-share-score">0</span> / 100 åˆ†ï¼</p>
                <p id="cicada-share-comment"></p>
            </div>
            <div class="cicada-share-image">
                <img src="images/taiwan_bear_cicada.jpg" alt="å°ç£ç†ŠèŸ¬" style="max-width: 200px;">
            </div>
            <div class="cicada-share-date">
                <p>æŒ‘æˆ°æ—¥æœŸ: <span id="cicada-share-date"></span></p>
            </div>
        </div>
        <div class="cicada-share-actions">
            <button id="cicada-download" class="cicada-button cicada-download-button">ä¸‹è¼‰åˆ†äº«åœ–</button>
        </div>
    </div>
</div>

<!-- JavaScript ä»£ç¢¼ -->
<script>
    // å›ºå®šçš„10é¡ŒéŠæˆ²é¡Œç›®
    const gameQuestions = [
        {
            id: 'question1',
            options: [
                {
                    id: 'taiwan_bear_cicada_1',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'cricket_1',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                },
                {
                    id: 'bird_chirping_1',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                },
                {
                    id: 'construction_noise_1',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/construction_noise.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question2',
            options: [
                {
                    id: 'frog_2',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                },
                {                    id: 'taiwan_bear_cicada_2',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'grasshopper_2',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                },
                {
                    id: 'bird_chirping_2',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question3',
            options: [
                {
                    id: 'construction_noise_3',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/construction_noise.mp3',
                    isCicada: false
                },
                {
                    id: 'grasshopper_3',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                },
                {                    id: 'red_vein_bear_cicada_3',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/red_vein_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'ç´…è„ˆç†ŠèŸ¬',
                    cicadaImage: 'images/red_vein_bear_cicada.jpg',
                    cicadaDescription: 'ç´…è„ˆç†ŠèŸ¬æ˜¯å°ç£å¸¸è¦‹çš„èŸ¬ç¨®ï¼Œé³´è²é«˜äº¢é€£çºŒï¼Œå¼·å¼±æœ‰è®ŠåŒ–ï¼Œå–œæ­¡åœ¨æ¨¹å† å±¤æ´»å‹•ã€‚'
                },
                {
                    id: 'cricket_3',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question4',
            options: [
                {
                    id: 'taiwan_bear_cicada_4',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },                {
                    id: 'taiwan_bear_cicada_4b',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'frog_4',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                },
                {
                    id: 'construction_noise_4',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/construction_noise.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question5',
            options: [
                {
                    id: 'bird_chirping_5',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                },
                {
                    id: 'cricket_5',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                },
                {                    id: 'red_vein_bear_cicada_5',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/red_vein_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'ç´…è„ˆç†ŠèŸ¬',
                    cicadaImage: 'images/red_vein_bear_cicada.jpg',
                    cicadaDescription: 'ç´…è„ˆç†ŠèŸ¬æ˜¯å°ç£å¸¸è¦‹çš„èŸ¬ç¨®ï¼Œé³´è²é«˜äº¢é€£çºŒï¼Œå¼·å¼±æœ‰è®ŠåŒ–ï¼Œå–œæ­¡åœ¨æ¨¹å† å±¤æ´»å‹•ã€‚'
                },
                {
                    id: 'grasshopper_5',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question6',
            options: [
                {
                    id: 'grasshopper_6',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                },
                {
                    id: 'construction_noise_6',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/construction_noise.mp3',
                    isCicada: false
                },
                {
                    id: 'taiwan_bear_cicada_6',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'frog_6',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question7',
            options: [
                {
                    id: 'frog_7',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                },
                {                    id: 'taiwan_bear_cicada_7',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'cricket_7',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                },
                {
                    id: 'bird_chirping_7',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question8',
            options: [
                {
                    id: 'highsand_cicada_8',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/highsand_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'é«˜ç ‚ç†ŠèŸ¬',
                    cicadaImage: 'images/highsand_cicada.jpg',
                    cicadaDescription: 'é«˜ç ‚ç†ŠèŸ¬æ˜¯å°ç£ç‰¹æœ‰ç¨®ï¼Œé³´è²åƒæ˜¯æŒçºŒçš„å˜¶å˜¶è²ï¼Œç¯€å¥ç·©æ…¢è€Œæœ‰åŠ›ï¼Œå¤šåœ¨å±±å€æ£®æ—ç’°å¢ƒå‡ºç¾ã€‚'
                },
                {
                    id: 'construction_noise_8',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/construction_noise.mp3',
                    isCicada: false
                },
                {
                    id: 'grasshopper_8',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                },
                {
                    id: 'bird_chirping_8',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question9',
            options: [
                {
                    id: 'grasshopper_9',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/grasshopper.mp3',
                    isCicada: false
                },
                {
                    id: 'taiwan_bear_cicada_9',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                },
                {
                    id: 'cricket_9',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                },
                {
                    id: 'frog_9',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                }
            ]
        },
        {
            id: 'question10',
            options: [
                {
                    id: 'cricket_10',
                    displayName: 'è²éŸ³ A',
                    filePath: 'audio/cricket.mp3',
                    isCicada: false
                },
                {
                    id: 'frog_10',
                    displayName: 'è²éŸ³ B',
                    filePath: 'audio/frog.mp3',
                    isCicada: false
                },
                {
                    id: 'bird_chirping_10',
                    displayName: 'è²éŸ³ C',
                    filePath: 'audio/bird_chirping.mp3',
                    isCicada: false
                },                {
                    id: 'taiwan_bear_cicada_10',
                    displayName: 'è²éŸ³ D',
                    filePath: 'audio/taiwan_bear_cicada.mp3',
                    isCicada: true,
                    cicadaSpecies: 'å°ç£ç†ŠèŸ¬',
                    cicadaImage: 'images/taiwan_bear_cicada.jpg',
                    cicadaDescription: 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚'
                }
            ]
        }
    ];
    
    // ç•¶å‰å›åˆçš„éŸ³æª”
    let currentRoundSounds = [];
      // ç•¶å‰æ’­æ”¾çš„éŸ³æª”
    let currentlyPlaying = null;
      
    // éŠæˆ²åˆ†æ•¸
    let score = 0;
    let currentQuestion = 0;
      // ç”¨æ–¼è¿½è¸ªç©å®¶æ­£ç¢ºè­˜åˆ¥çš„èŸ¬ç¨®
    let identifiedCicadas = {
        "ç´…è„ˆç†ŠèŸ¬": 0,
        "å°ç£ç†ŠèŸ¬": 0,
        "å°ç£é¨·èŸ¬": 0
    };
    
    // å»ºç«‹ä¸€å€‹å…¨å±€è®Šæ•¸ä¾†å­˜å„²ç•¶å‰çš„éŠæˆ²é¡Œç›®
    let currentGameQuestions = [];
    
    // æ´—ç‰Œç®—æ³•
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    
    // éŠæˆ²åˆå§‹åŒ–
    function initGame() {
        // é‡ç½®éŠæˆ²ç‹€æ…‹
        score = 0;
        currentQuestion = 0;
        
        // éš¨æ©Ÿé¸å–5é“é¡Œç›®ä¸¦ç¢ºä¿æ¯é¡Œæœ‰è‡³å°‘ä¸€å€‹èŸ¬é³´
        let selectedQuestions = [];
        
        // å°‡é¡Œç›®æ´—ç‰Œå¾Œå–å‰5é¡Œ
        let shuffledQuestions = shuffleArray([...gameQuestions]);
        selectedQuestions = shuffledQuestions.slice(0, 5);
          // ç¢ºä¿æ¯é¡Œåªæœ‰ä¸€å€‹èŸ¬é³´é¸é …
        selectedQuestions.forEach((question, index) => {
            // æ‰¾å‡ºæ‰€æœ‰èŸ¬é³´é¸é …
            const cicadaOptions = question.options.filter(option => option.isCicada);
            const nonCicadaOptions = question.options.filter(option => !option.isCicada);
            
            // å¦‚æœæ²’æœ‰èŸ¬é³´é¸é …ï¼Œæ·»åŠ ä¸€å€‹
            if (cicadaOptions.length === 0) {
                // å¾å…¶ä»–é¡Œç›®ä¸­æ‰¾ä¸€å€‹èŸ¬é³´é¸é …æ·»åŠ 
                for (let i = 0; i < gameQuestions.length; i++) {
                    const cicadaOption = gameQuestions[i].options.find(option => option.isCicada);
                    if (cicadaOption) {
                        // æ·»åŠ æ­¤èŸ¬é³´é¸é …æ›¿æ›ä¸€å€‹éèŸ¬é³´é¸é …
                        if (nonCicadaOptions.length > 0) {
                            const nonCicadaIndex = Math.floor(Math.random() * question.options.length);
                            question.options[nonCicadaIndex] = {...cicadaOption};
                            break;
                        }
                    }
                }
            }
            // å¦‚æœæœ‰å¤šå€‹èŸ¬é³´é¸é …ï¼Œåªä¿ç•™ä¸€å€‹
            else if (cicadaOptions.length > 1) {
                // éš¨æ©Ÿé¸æ“‡ä¸€å€‹èŸ¬é³´é¸é …ä¿ç•™
                const keepCicadaIndex = Math.floor(Math.random() * cicadaOptions.length);
                
                // å°‡å…¶ä»–èŸ¬é³´é¸é …æ›¿æ›ç‚ºéèŸ¬é³´é¸é …
                question.options.forEach((option, idx) => {
                    if (option.isCicada) {
                        if (cicadaOptions.indexOf(option) !== keepCicadaIndex) {
                            // ç”¨ä¸€å€‹éèŸ¬é³´çš„éŸ³æ•ˆæ›¿æ›
                            const nonCicadaSounds = ['audio/bird_chirping.mp3', 'audio/cricket.mp3', 
                                                    'audio/city_noise_1.mp3', 'audio/construction_noise.mp3'];
                            const randomSound = nonCicadaSounds[Math.floor(Math.random() * nonCicadaSounds.length)];
                            question.options[idx] = {
                                id: `non_cicada_${idx}_${index}`,
                                displayName: option.displayName,
                                filePath: randomSound,
                                isCicada: false
                            };
                        }
                    }
                });
            }
            
            // éš¨æ©Ÿæ‰“äº‚å„é¡Œçš„é¸é …é †åº
            question.options = shuffleArray([...question.options]);
        });
        
        // æ›´æ–°ç•¶å‰éŠæˆ²é¡Œåº«ç‚ºé¸å¥½çš„5é¡Œ
        currentGameQuestions = selectedQuestions;
        
        // è¼‰å…¥ç¬¬ä¸€é¡Œ
        loadQuestion();
    }
    
    // è¼‰å…¥ç•¶å‰å•é¡Œ
    function loadQuestion() {
        // æª¢æŸ¥æ˜¯å¦å·²å®Œæˆæ‰€æœ‰å•é¡Œ
        if (currentQuestion >= currentGameQuestions.length) {
            showResultScreen();
            return;
        }
        
        // é‡ç½®UIå…ƒç´ 
        document.getElementById('cicada-sound-options').innerHTML = '';
        document.getElementById('cicada-submit').style.display = 'inline-block';
        document.getElementById('cicada-next').style.display = 'none';
        document.getElementById('cicada-feedback').style.display = 'none';
        
        // ç²å–ç•¶å‰å•é¡Œçš„é¸é …
        if (currentGameQuestions[currentQuestion] && currentGameQuestions[currentQuestion].options) {
            currentRoundSounds = currentGameQuestions[currentQuestion].options;
              // å‹•æ…‹ç”ŸæˆéŸ³æª”é¸é …
            createSoundOptions();
            
            // æ›´æ–°è¨ˆåˆ†æ¿
            updateScoreboard();
        } else {
            console.error("éŒ¯èª¤ï¼šç•¶å‰å•é¡Œæˆ–é¸é …æœªå®šç¾©", currentQuestion, currentGameQuestions);
        }
    }
    
    // å‹•æ…‹å‰µå»ºéŸ³æª”é¸é …
    function createSoundOptions() {
        const container = document.getElementById('cicada-sound-options');
        
        currentRoundSounds.forEach(sound => {
            // å‰µå»ºéŸ³æª”å¡ç‰‡
            const card = document.createElement('div');
            card.className = 'cicada-sound-card';
            card.dataset.soundId = sound.id;
            
            // å‰µå»ºæ’­æ”¾æŒ‰éˆ•
            const playButton = document.createElement('button');
            playButton.className = 'cicada-play-button';
            playButton.innerHTML = '<span class="icon">â–¶</span>';
            playButton.onclick = () => togglePlaySound(sound.filePath, playButton);
            
            // å‰µå»ºå‹¾é¸æ¡†å’Œæ¨™ç±¤
            const label = document.createElement('label');
            label.className = 'cicada-sound-label';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'cicada-checkbox';
            checkbox.dataset.soundId = sound.id;
            
            const labelText = document.createTextNode(sound.displayName);
            
            label.appendChild(checkbox);
            label.appendChild(labelText);
            
            // çµ„åˆå…ƒç´ 
            card.appendChild(playButton);
            card.appendChild(label);
            container.appendChild(card);
        });
    }
    
    // æ’­æ”¾/æš«åœéŸ³æª”
    function togglePlaySound(soundPath, button) {
        // å¦‚æœæœ‰æ­£åœ¨æ’­æ”¾çš„éŸ³æª”ï¼Œåœæ­¢å®ƒ
        if (currentlyPlaying) {
            currentlyPlaying.pause();
            currentlyPlaying.currentTime = 0;
            
            // é‡è¨­æ‰€æœ‰æ’­æ”¾æŒ‰éˆ•
            document.querySelectorAll('.cicada-play-button').forEach(btn => {
                btn.innerHTML = '<span class="icon">â–¶</span>';
                btn.classList.remove('playing');
            });
        }
        
        // å‰µå»ºæ–°çš„éŸ³æª”æ’­æ”¾å¯¦ä¾‹
        const audio = new Audio(soundPath);
        
        // æ’­æ”¾æ–°éŸ³æª”
        audio.play();
        button.innerHTML = '<span class="icon">â¸</span>';
        button.classList.add('playing');
        currentlyPlaying = audio;
        
        // éŸ³æª”æ’­æ”¾çµæŸäº‹ä»¶
        audio.onended = () => {
            button.innerHTML = '<span class="icon">â–¶</span>';
            button.classList.remove('playing');
            currentlyPlaying = null;
        };
    }
      // æäº¤ç­”æ¡ˆ
    function submitAnswer() {
        // æª¢æŸ¥æ˜¯å¦è‡³å°‘é¸æ“‡äº†ä¸€å€‹é¸é …
        const hasSelection = Array.from(document.querySelectorAll('.cicada-checkbox')).some(checkbox => checkbox.checked);
        
        if (!hasSelection) {
            alert('è«‹è‡³å°‘é¸æ“‡ä¸€å€‹ä½ èªç‚ºæ˜¯èŸ¬é³´çš„é¸é …ï¼');
            return;
        }
        
        // ç¦ç”¨æäº¤æŒ‰éˆ•
        document.getElementById('cicada-submit').style.display = 'none';
        document.getElementById('cicada-next').style.display = 'inline-block';
        
        // ç¦ç”¨æ‰€æœ‰å‹¾é¸æ¡†
        document.querySelectorAll('.cicada-checkbox').forEach(checkbox => {
            checkbox.disabled = true;
        });
        
        // åœæ­¢æ­£åœ¨æ’­æ”¾çš„éŸ³æª”
        if (currentlyPlaying) {
            currentlyPlaying.pause();
            currentlyPlaying = null;
        }
        
        // æª¢æŸ¥ç­”æ¡ˆ
        checkAnswers();
    }
      // æª¢æŸ¥ç­”æ¡ˆ
    function checkAnswers() {
        const feedbackElement = document.getElementById('cicada-feedback');
        let isAllCorrect = true;
        let cicadaFound = false;
        
        // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰é¸é …éƒ½æ­£ç¢º
        currentRoundSounds.forEach(sound => {
            const checkbox = document.querySelector(`.cicada-checkbox[data-sound-id="${sound.id}"]`);
            const isChecked = checkbox.checked;
            
            // æ¨™è¨˜æ­£ç¢º/éŒ¯èª¤
            const card = document.querySelector(`.cicada-sound-card[data-sound-id="${sound.id}"]`);
            
            if ((sound.isCicada && isChecked) || (!sound.isCicada && !isChecked)) {
                card.style.border = '2px solid #2ecc71';
            } else {
                card.style.border = '2px solid #e74c3c';
                isAllCorrect = false;
            }
            
            // æª¢æŸ¥æ˜¯å¦æ‰¾åˆ°èŸ¬é³´
            if (sound.isCicada && isChecked) {
                cicadaFound = true;
            }
        });
        
        // æ›´æ–°åé¥‹å€åŸŸ
        feedbackElement.style.display = 'block';
        
        if (isAllCorrect) {
            feedbackElement.className = 'cicada-feedback correct';
            feedbackElement.innerHTML = '<h3>æ­å–œï¼ä½ ç­”å°äº†ï¼</h3><p>èŸ¬çš„å«è²é€šå¸¸æ¯”è¼ƒé€£çºŒè€Œä¸”é«˜äº¢ï¼Œç¯€å¥ç‰¹æ®Šã€‚</p>';
            score += 10; // æ¯é¡Œ10åˆ†
            
            // å¦‚æœç­”å°ï¼Œä¸”æ‰¾åˆ°äº†èŸ¬é³´
            if (cicadaFound) {
                // æ‰¾å‡ºè¢«é¸ä¸­çš„èŸ¬ç¨®
                const selectedCicadas = currentRoundSounds.filter(sound => 
                    sound.isCicada && document.querySelector(`.cicada-checkbox[data-sound-id="${sound.id}"]`).checked
                );
                
                if (selectedCicadas.length > 0) {
                    // ç´¯åŠ ç©å®¶è­˜åˆ¥çš„èŸ¬ç¨®
                    selectedCicadas.forEach(cicada => {
                        if (identifiedCicadas.hasOwnProperty(cicada.cicadaSpecies)) {
                            identifiedCicadas[cicada.cicadaSpecies]++;
                        }
                    });
                    
                    // éš¨æ©Ÿé¸ä¸€å€‹èŸ¬ç¨®é¡¯ç¤º
                    const cicadaToShow = selectedCicadas[Math.floor(Math.random() * selectedCicadas.length)];
                    
                    // é¡¯ç¤ºè³‡è¨Šå¾Œï¼Œè‡ªå‹•é€²å…¥ä¸‹ä¸€é¡Œ
                    setTimeout(() => {
                        showCicadaInfo(cicadaToShow);
                    }, 800); // çµ¦ä½¿ç”¨è€…ä¸€äº›æ™‚é–“æŸ¥çœ‹ç­”å°çš„åé¥‹
                }
            }
        } else {
            feedbackElement.className = 'cicada-feedback incorrect';
            
            // æ‰¾å‡ºæ­£ç¢ºçš„èŸ¬é³´é¸é …
            const correctCicadaOptions = currentRoundSounds
                .filter(sound => sound.isCicada)
                .map(sound => sound.displayName)
                .join('ã€');
            
            feedbackElement.innerHTML = `
                <h3>å·®ä¸€é»é»ï¼</h3>
                <p>èŸ¬çš„å«è²é€šå¸¸å…·æœ‰é€£çºŒã€é«˜äº¢çš„ç‰¹é»ï¼Œç¯€å¥è¼ƒç‚ºè¦å‰‡ã€‚é€™äº›è²éŸ³ä¸­ï¼Œ${correctCicadaOptions} æ‰æ˜¯èŸ¬é³´å–”ã€‚</p>
            `;
            // ç­”éŒ¯ä¸åŠ åˆ†
        }
        
        // æ›´æ–°è¨ˆåˆ†æ¿
        updateScoreboard();
        
        // æ›´æ–°é¡Œç›®è¨ˆæ•¸
        currentQuestion++;
        
        // å¦‚æœæ˜¯æœ€å¾Œä¸€é¡Œï¼Œæ›´æ”¹æŒ‰éˆ•æ–‡å­—
        if (currentQuestion >= gameQuestions.length) {
            document.getElementById('cicada-next').textContent = 'æŸ¥çœ‹çµæœ';
        }
    }
    
    // é¡¯ç¤ºèŸ¬ç¨®è³‡è¨Šå½ˆçª—
    function showCicadaInfo(cicada) {
        const modal = document.getElementById('cicada-modal');
        const speciesName = document.getElementById('cicada-species-name');
        const speciesImage = document.getElementById('cicada-species-image');
        const speciesDesc = document.getElementById('cicada-species-description');
        
        // è¨­ç½®å½ˆçª—å…§å®¹
        speciesName.textContent = cicada.cicadaSpecies;
        speciesImage.src = cicada.cicadaImage;
        speciesImage.alt = cicada.cicadaSpecies;
        speciesDesc.textContent = cicada.cicadaDescription;
        
        // é¡¯ç¤ºå½ˆçª—
        modal.style.display = 'flex';
        
        // 3ç§’å¾Œè‡ªå‹•é—œé–‰å½ˆçª—ä¸¦é€²å…¥ä¸‹ä¸€é¡Œ
        setTimeout(() => {
            modal.style.display = 'none';
            loadQuestion(); // è‡ªå‹•è¼‰å…¥ä¸‹ä¸€é¡Œ
        }, 3000);
    }
    
    // æ›´æ–°è¨ˆåˆ†æ¿
    function updateScoreboard() {
        document.getElementById('cicada-score').textContent = score;
        document.getElementById('cicada-current-question').textContent = currentQuestion + 1;
    }
      // ä¸‹ä¸€å›åˆæˆ–é¡¯ç¤ºçµæœ
    function nextRound() {
        if (currentQuestion >= currentGameQuestions.length) {
            showResultScreen();
        } else {
            loadQuestion();
        }
    }
    
    // é¡¯ç¤ºçµç®—ç•«é¢
    function showResultScreen() {
        // æ›´æ–°æœ€çµ‚åˆ†æ•¸
        document.getElementById('cicada-final-score').textContent = score;
          
        // æ ¹æ“šåˆ†æ•¸çµ¦äºˆè©•èª
        const commentElement = document.getElementById('cicada-score-comment');
        if (score >= 45) {
            commentElement.textContent = 'å¤ªå²å®³äº†ï¼ä½ å°èŸ¬é³´æœ‰è‘—å°ˆæ¥­ç´šçš„è¾¨è­˜èƒ½åŠ›ï¼';
        } else if (score >= 35) {
            commentElement.textContent = 'å¾ˆæ£’ï¼ä½ å°èŸ¬é³´çš„è¾¨è­˜èƒ½åŠ›ç›¸ç•¶å„ªç§€ï¼';
        } else if (score >= 25) {
            commentElement.textContent = 'åšå¾—å¥½ï¼ä½ å°èŸ¬é³´æœ‰ä¸€å®šçš„è¾¨è­˜èƒ½åŠ›ã€‚';
        } else if (score >= 15) {
            commentElement.textContent = 'é‚„ä¸éŒ¯ï¼ç¹¼çºŒç·´ç¿’ï¼Œä½ æœƒæ›´ç†Ÿæ‚‰èŸ¬é³´çš„ç‰¹è‰²ã€‚';
        } else {
            commentElement.textContent = 'é€™äº›èŸ¬è²ç¢ºå¯¦ä¸å¤ªå®¹æ˜“è¾¨åˆ¥ï¼Œä¸å¦¨å†æŒ‘æˆ°ä¸€æ¬¡å§ï¼';
        }
        
        // æ‰¾å‡ºç©å®¶æœ€å¸¸è­˜åˆ¥æ­£ç¢ºçš„èŸ¬ç¨®
        let maxCount = 0;
        let mostIdentifiedCicada = "å°ç£é¨·èŸ¬"; // é è¨­å€¼
        
        for (const [cicadaName, count] of Object.entries(identifiedCicadas)) {
            console.log(`ç©å®¶è­˜åˆ¥ ${cicadaName}: ${count} æ¬¡`);
            if (count > maxCount) {
                maxCount = count;
                mostIdentifiedCicada = cicadaName;
            }
        }
        
        // æ›´æ–°çµç®—ç•«é¢é¡¯ç¤ºçš„èŸ¬ç¨®
        const cicadaInfoTitle = document.querySelector('.cicada-info-box h3');
        const cicadaInfoImage = document.querySelector('.cicada-info-box img');
        const cicadaInfoDesc = document.querySelector('.cicada-info-box p');
        
        // æ ¹æ“šæœ€å¸¸è­˜åˆ¥çš„èŸ¬ç¨®è¨­ç½®å…§å®¹
        cicadaInfoTitle.textContent = mostIdentifiedCicada;
          if (mostIdentifiedCicada === "ç´…è„ˆç†ŠèŸ¬") {
            cicadaInfoImage.src = 'images/red_vein_bear_cicada.jpg';
            cicadaInfoImage.alt = 'ç´…è„ˆç†ŠèŸ¬';
            cicadaInfoDesc.textContent = 'ç´…è„ˆç†ŠèŸ¬æ˜¯å°ç£å¸¸è¦‹çš„èŸ¬ç¨®ï¼Œé³´è²é«˜äº¢é€£çºŒï¼Œå¼·å¼±æœ‰è®ŠåŒ–ï¼Œå–œæ­¡åœ¨æ¨¹å† å±¤æ´»å‹•ã€‚';
        }else if (mostIdentifiedCicada === "å°ç£ç†ŠèŸ¬") {
            cicadaInfoImage.src = 'images/taiwan_bear_cicada.jpg';
            cicadaInfoImage.alt = 'å°ç£ç†ŠèŸ¬';
            cicadaInfoDesc.textContent = 'å°ç£ç†ŠèŸ¬æ˜¯å°ç£é«”å‹æœ€å¤§çš„èŸ¬ä¹‹ä¸€ï¼Œå«è²éå¸¸éŸ¿äº®ä¸”æŒä¹…ï¼Œé€šå¸¸åœ¨å¤å­£çš„ä¸Šåˆæˆ–ä¸‹åˆé³´å«æœ€ç‚ºæ´»èºã€‚';
        } else {
            cicadaInfoImage.src = 'images/taiwan_noisy_cicada.jpg';
            cicadaInfoImage.alt = 'å°ç£é¨·èŸ¬';
            cicadaInfoDesc.textContent = 'å°ç£é¨·èŸ¬é³´è²æ€¥ä¿ƒä¸”å…·æœ‰ç¯€å¥æ„Ÿï¼Œè²èª¿è®ŠåŒ–è±å¯Œï¼Œæ˜¯å°ç£å¤å­£å¸¸è¦‹çš„èŸ¬ç¨®ï¼Œé€šå¸¸æ£²æ¯åœ¨ä¸­ä½æµ·æ‹”åœ°å€ã€‚ç‰ å€‘èº«é«”è¼ƒå°ï¼Œé³´å«è²å…·æœ‰ç¨ç‰¹çš„é »ç‡è®ŠåŒ–ï¼Œèƒ½å¤ è¿…é€Ÿè¾¨è­˜ã€‚';
        }
        
        // æ›´æ–°åˆ†äº«ç•«é¢çš„èŸ¬ç¨®åœ–ç‰‡
        document.querySelector('.cicada-share-image img').src = cicadaInfoImage.src;
        document.querySelector('.cicada-share-image img').alt = cicadaInfoImage.alt;
        
        // é¡¯ç¤ºçµç®—å½ˆçª—
        document.getElementById('cicada-result-modal').style.display = 'flex';
    }
    
    // é‡æ–°é–‹å§‹éŠæˆ²
    function restartGame() {
        // é—œé–‰çµç®—å½ˆçª—
        document.getElementById('cicada-result-modal').style.display = 'none';
        
        // æ¸…ç©ºèˆŠçš„éŸ³æª”é¸é …
        document.getElementById('cicada-sound-options').innerHTML = '';
        document.getElementById('cicada-feedback').style.display = 'none';
        
        // é‡ç½®åˆ†æ•¸å’Œé¡Œç›®è¨ˆæ•¸
        score = 0;
        currentQuestion = 0;
          // é‡ç½®èŸ¬ç¨®è­˜åˆ¥è¨ˆæ•¸
        identifiedCicadas = {
            "ç´…è„ˆç†ŠèŸ¬": 0,
            "å°ç£ç†ŠèŸ¬": 0,
            "å°ç£é¨·èŸ¬": 0
        };
        
        // å¦‚æœæœ‰æ­£åœ¨æ’­æ”¾çš„éŸ³æª”ï¼Œåœæ­¢å®ƒ
        if (currentlyPlaying) {
            currentlyPlaying.pause();
            currentlyPlaying = null;
        }
        
        // åˆå§‹åŒ–éŠæˆ²ï¼Œé‡æ–°é¸æ“‡é¡Œç›®
        initGame();
    }
    
    // é¡¯ç¤ºåˆ†äº«ç•«é¢
    function showShareScreen() {
        // æ›´æ–°åˆ†äº«ç•«é¢ä¸Šçš„åˆ†æ•¸å’Œè©•èª
        document.getElementById('cicada-share-score').textContent = score;
        document.getElementById('cicada-share-comment').textContent = document.getElementById('cicada-score-comment').textContent;
        
        // è¨­ç½®æ—¥æœŸ
        const today = new Date();
        const dateString = today.getFullYear() + '/' + (today.getMonth() + 1) + '/' + today.getDate();
        document.getElementById('cicada-share-date').textContent = dateString;
        
        // ç¢ºä¿åˆ†äº«ç•«é¢ä½¿ç”¨çš„èŸ¬åœ–ç‰‡èˆ‡çµæœç•«é¢ä¸€è‡´
        const resultImg = document.querySelector('.cicada-info-box img');
        document.querySelector('.cicada-share-image img').src = resultImg.src;
        document.querySelector('.cicada-share-image img').alt = resultImg.alt;
        
        // é¡¯ç¤ºåˆ†äº«å½ˆçª—
        document.getElementById('cicada-share-modal').style.display = 'flex';
    }
    
    // ä¸‹è¼‰åˆ†äº«åœ–ç‰‡
    function downloadShareImage() {
        // ä½¿ç”¨ html2canvas åº«å°‡æˆªåœ–å€åŸŸè½‰æ›ç‚ºåœ–ç‰‡
        html2canvas(document.getElementById('cicada-screenshot-area')).then(canvas => {
            // å‰µå»ºä¸€å€‹ç”¨æ–¼ä¸‹è¼‰çš„éˆæ¥
            const link = document.createElement('a');
            link.download = 'èŸ¬é³´çŸ¥å¤šå°‘-æŒ‘æˆ°çµæœ.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        });
    }
    
    // ç¶å®šäº‹ä»¶
    document.getElementById('cicada-submit').addEventListener('click', submitAnswer);
    document.getElementById('cicada-next').addEventListener('click', nextRound);
    document.getElementById('cicada-modal-close').addEventListener('click', () => {
        document.getElementById('cicada-modal').style.display = 'none';
    });
    document.getElementById('cicada-result-close').addEventListener('click', () => {
        document.getElementById('cicada-result-modal').style.display = 'none';
    });
    document.getElementById('cicada-restart').addEventListener('click', restartGame);
    document.getElementById('cicada-share').addEventListener('click', showShareScreen);
    document.getElementById('cicada-share-close').addEventListener('click', () => {
        document.getElementById('cicada-share-modal').style.display = 'none';
    });
    document.getElementById('cicada-download').addEventListener('click', downloadShareImage);
    
    // é¦–æ¬¡åˆå§‹åŒ–éŠæˆ²
    window.addEventListener('DOMContentLoaded', () => {
        // è¼‰å…¥ html2canvas åº«ï¼Œç”¨æ–¼ç”Ÿæˆåˆ†äº«åœ–ç‰‡
        const script = document.createElement('script');
        script.src = 'https://html2canvas.hertzen.com/dist/html2canvas.min.js';
        script.onload = initGame; // è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–éŠæˆ²
        document.head.appendChild(script);    });
</script>
<!-- çŸ¥äº†å˜’å˜’éŠæˆ² - çµæŸ -->
<!-- èŸ¬é³´çŸ¥å¤šå°‘éŠæˆ² - çµæŸ -->
